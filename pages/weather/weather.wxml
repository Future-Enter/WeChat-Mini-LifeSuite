<!--pages/weather/weather.wxml-->
<!-- å¯¼å…¥æ¨¡æ¿æ–‡ä»¶ -->
<import src="templates.wxml" />

<view class="container">
  <!-- æœç´¢åŒºåŸŸ -->
  <view class="search-section">
    <view class="search-card">
      <form bindsubmit="searchCity">
        <view class="search-inputs">
          <view class="input-item">
            <text class="input-label">çœä»½</text>
            <input 
              name="province" 
              placeholder="å¦‚ï¼šé»‘é¾™æ±Ÿçœ" 
              value="{{formData.province}}"
              bindinput="onInputChange"
              data-field="province"
              class="search-input"
            />
          </view>
          <view class="input-item">
            <text class="input-label">åŸå¸‚</text>
            <input 
              name="city" 
              placeholder="å¦‚ï¼šå“ˆå°”æ»¨" 
              value="{{formData.city}}"
              bindinput="onInputChange"
              data-field="city"
              class="search-input"
            />
          </view>
        </view>
        <button 
          form-type="submit" 
          type="primary" 
          size="default"
          loading="{{isLoading}}"
          class="search-btn"
        >
          <text class="btn-text">æŸ¥è¯¢å¤©æ°”</text>
          <text class="btn-icon">ğŸ”</text>
        </button>
      </form>
    </view>
  </view>

  <!-- å½“å‰å¤©æ°”å¡ç‰‡ -->
  <view class="weather-card" wx:if="{{weatherInfo}}">
    <view class="card-header">
      <view class="location-info">
        <text class="city-name">{{LocationName}}</text>
        <text class="weather-desc">{{weatherInfo.weather}}</text>
      </view>
      <view class="update-time">
        <text>æ›´æ–°: {{weatherInfo.updateTime ? weatherInfo.updateTime.slice(11, 16) : ''}}</text>
      </view>
    </view>

    <!-- ä½¿ç”¨currentWeatheræ¨¡æ¿ -->
    <template is="currentWeather" data="{{...weatherInfo}}" />
  </view>

 <!-- 7å¤©å¤©æ°”é¢„æŠ¥ - å·¦å³æ»‘åŠ¨æ˜¾ç¤º -->
<!-- 7å¤©å¤©æ°”é¢„æŠ¥ - å·¦å³æ»‘åŠ¨æ˜¾ç¤º -->
<view class="forecast-section" wx:if="{{dailyForecast.length > 0}}">
  <view class="section-header">
    <text class="section-title">7å¤©é¢„æŠ¥</text>
    <text class="section-subtitle">å·¦å³æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š</text>
  </view>

  <view class="forecast-scroll-container">
    <scroll-view 
      class="forecast-scroll" 
      scroll-x="true" 
      enhanced="true" 
      show-scrollbar="{{false}}"
      bindscroll="onScroll"
      scroll-left="{{scrollLeft}}"
    >
      <view class="forecast-list">
        <block wx:for="{{dailyForecast}}" wx:key="index">
          <view class="forecast-item {{item.isToday ? 'today' : ''}} {{item.isTomorrow ? 'tomorrow' : ''}}">
            <!-- æ—¥æœŸä¿¡æ¯ -->
            <view class="forecast-date">
              <text class="day-week">{{item.isToday ? 'ä»Šå¤©' : item.isTomorrow ? 'æ˜å¤©' : item.week}}</text>
              <text class="day-date">{{item.date}}</text>
              <view class="today-indicator" wx:if="{{item.isToday}}">
                <text>ä»Šæ—¥</text>
              </view>
            </view>
            
            <!-- å¤©æ°”å›¾æ ‡å’Œæè¿° -->
            <view class="forecast-weather">
              <image class="weather-icon" src="/res/icons/{{item.iconDay}}.svg" mode="aspectFit" />
              <text class="weather-text">{{item.weather}}</text>
            </view>

            <!-- æ¸©åº¦èŒƒå›´ -->
            <view class="temperature-range">
              <text class="temp-high">{{item.tempMax}}Â°</text>
              <text class="temp-low">{{item.tempMin}}Â°</text>
            </view>

            <!-- å¤©æ°”è¯¦æƒ… -->
            <view class="forecast-details">
              <text class="precip">ğŸ’§ {{item.precip}}%</text>
              <text class="wind">ğŸ’¨ {{item.windScaleDay}}çº§</text>
            </view>
          </view>
        </block>
      </view>
    </scroll-view>
    
    <!-- æ»‘åŠ¨æŒ‡ç¤ºå™¨ -->
    <!-- æ»‘åŠ¨æŒ‡ç¤ºå™¨ -->
<view class="section-indicator">
  <text class="indicator-dot {{indicatorDots[0] ? 'active' : ''}}"></text>
  <text class="indicator-dot {{indicatorDots[1] ? 'active' : ''}}"></text>
  <text class="indicator-dot {{indicatorDots[2] ? 'active' : ''}}"></text>
</view>
    
  </view>
</view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text>æ­£åœ¨è·å–å¤©æ°”æ•°æ®...</text>
  </view>

  <!-- æ— æ•°æ®æç¤º -->
  <view class="empty-state" wx:if="{{!weatherInfo && !isLoading}}">
    <text class="empty-icon">ğŸŒ¤ï¸</text>
    <text class="empty-text">è¾“å…¥åŸå¸‚åç§°æŸ¥çœ‹å¤©æ°”</text>
  </view>
</view>